<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dramalog - Login</title>
  <style>
    :root {
      --bg: #f3f3f3;
      --card: #ffffff;
      --text: #111111;
      --muted: #666666;
      --line: #d9d9d9;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
      --radius: 18px;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      display: grid;
      place-items: center;
    }

    .window {
      width: 760px;
      max-width: calc(100vw - 32px);
      background: #fff;
      border-radius: 24px;
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid #e9e9e9;
    }

    .titlebar {
      padding: 14px 18px;
      background: #fafafa;
      border-bottom: 1px solid #ececec;
      text-align: center;
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .content {
      padding: 54px 24px 60px;
      display: grid;
      place-items: center;
    }

    .logo {
		width: 160px;
		height: auto;
		margin-bottom: 28px;
		filter: grayscale(100%);
    }

    .brand {
      margin: 6px 0 34px;
      font-weight: 800;
      letter-spacing: 1.2px;
    }

    .form {
      width: 320px;
      display: grid;
      gap: 18px;
    }

    label {
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
      display: block;
      text-transform: lowercase;
      letter-spacing: 0.3px;
    }

    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    input {
      width: 100%;
      box-sizing: border-box;
      padding: 14px 14px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: #fff;
      font-size: 14px;
      outline: none;
    }

    input:focus {
      border-color: #999;
    }

    .btn {
      margin-top: 10px;
      padding: 14px 16px;
      border-radius: 14px;
      border: 1px solid #dcdcdc;
      background: #fff;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
    }

    .btn:active { transform: translateY(1px); }

    .error {
      display: none;
      width: 320px;
      margin-top: 14px;
      color: #b00020;
      font-size: 13px;
      text-align: center;
    }

    .footer {
      margin-top: 18px;
      font-size: 12px;
      color: var(--muted);
      text-align: center;
    }
  </style>
</head>
<body>

<div class="window">

  <div class="content">
    <!-- 로고: static/img/logo.png -->
	<img src="/logo.png" class="logo" alt="Dramalog Logo">

    <form class="form" id="loginForm">
      <div>
        <label for="name">name</label>
        <input id="name" name="name" type="text" autocomplete="username" required />
      </div>

      <div>
        <label for="pin4">PIN</label>
		<input id="pin4" name="pin4" type="text"
		       inputmode="numeric"
		       autocomplete="one-time-code"
		       pattern="[0-9]{4}" maxlength="4" required />
        <div class="hint">숫자 네 자리를 입력해 주세요.</div>
      </div>

      <button class="btn" type="submit">CHECK IN</button>
    </form>

    <div class="error" id="errorBox"></div>

    <div class="footer">
      첫 가입이라면, 자동으로 계정이 생성됩니다.
    </div>
  </div>
</div>

<script>
  const form = document.getElementById("loginForm");
  const errorBox = document.getElementById("errorBox");

  function showError(msg) {
    errorBox.textContent = msg;
    errorBox.style.display = "block";
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    errorBox.style.display = "none";

    const name = document.getElementById("name").value.trim();
    const pin4 = document.getElementById("pin4").value.trim();

    if (!/^\d{4}$/.test(pin4)) {
      showError("PIN must be exactly 4 digits.");
      return;
    }

    try {
      const res = await fetch("/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, pin4 }),
      });

      if (!res.ok) {
        showError("Login failed. Please try again.");
        return;
      }

      // 성공 시 홈으로 이동
      window.location.href = "/";
    } catch (err) {
      showError("Server connection error.");
    }
  });
</script>

</body>
</html>